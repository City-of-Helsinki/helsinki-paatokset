jQuery((function(e){const n=e(".issue__meetings-dropdown button"),t=e(".issue__meetings-select"),s=e(".issue__meetings-select li"),a=e(".issue__meetings-container"),o=e(".issue__meetings-dropdown"),i=e(".social-media__items a");let r=-1;function d(s=!0){e(t).hide(),e(t).attr("aria-expanded","false"),e(o).removeClass("open"),s&&e(n).focus()}function l(t){!t.key||"ArrowUp"!==t.key&&"ArrowDown"!==t.key||("ArrowUp"===t.key&&r>-1&&r--,"ArrowDown"===t.key&&r<s.length-1&&r++,r>=0&&r<s.length&&e(s)[r].focus(),-1===r&&n.focus())}function c(t){e(t).data("link")!==e(n).data("link")?(e(t).length>0&&(u(t),e(".issue__meetings-dropdown .hds-button__label").html(e(t).text()),e(".issue__meetings-select li.selected").attr("aria-selected","false"),e(".issue__meetings-select li.selected").removeClass("selected"),e(t).addClass("selected"),e(t).attr("aria-selected","true"),d()),function(n){const t=e("#case-header").data("caseId"),{baseUrl:s,pathPrefix:a,currentPath:o}=window.drupalSettings.path,r=`${s}${a}ahjo_api/case/${t}/${n}`;e.ajax({url:r,beforeSend:function(){e(".issue__wrapper .ajax-progress-throbber").show()},success:function(n){if(n.content&&e(".issue__ajax-container").html(n.content),n.attachments&&e(".issue__attachments__wrapper").html(n.attachments),n.decision_navigation&&e(".issue__decision-navigation__wrapper").html(n.decision_navigation),n.all_decisions_link?(e(".issue-dropdown__show-more a").attr("href",n.all_decisions_link),e(".issue-dropdown__show-more a span").text(Drupal.t("Other decisions for the meeting")),e(".issue-dropdown__show-more").css("display","block")):n.other_decisions_link?(e(".issue-dropdown__show-more a").attr("href",n.other_decisions_link),e(".issue-dropdown__show-more a span").text(Drupal.t("Other decisions for the policymaker")),e(".issue-dropdown__show-more").css("display","block")):e(".issue-dropdown__show-more").css("display","none"),n.decision_pdf?(e(".issue__pdf a").attr("href",n.decision_pdf),e(".issue__pdf").css("display","block")):e(".issue__pdf").css("display","none"),n.language_urls)for(let t in n.language_urls)e('.language-link[lang="'+t+'"]').attr("href",n.language_urls[t]);n.show_warning?e(".issue__new-handlings-warning").addClass("visible"):e(".issue__new-handlings-warning").removeClass("visible"),e(".issue-ajax-error__container").hide()},error:function(){e(".issue-ajax-error__container .hds-notification__label").attr("aria-hidden","false"),e(".issue-ajax-error__container").attr("aria-hidden","false").show()},complete:function(){e(".issue__wrapper .ajax-progress-throbber").hide(),window.document.dispatchEvent(new Event("DOMContentLoaded",{bubbles:!0,cancelable:!0}))}});let d="paatos";"sv"===window.drupalSettings.path.currentLanguage?d="beslut":"en"===window.drupalSettings.path.currentLanguage&&(d="decision");let l=window.location.search;""===l&&(l="?"+d+"=");const c=window.location.host+window.location.pathname+l;window.history.pushState({},"",`${window.location.pathname}?${d}=${n}`),i.each((function(){const n=e(this).attr("href"),t=window.location.host+window.location.pathname+window.location.search;e(this).attr("href",n.replace(c,t))}))}(e(t).data("link"))):d()}function u(t){const s=e(t).data("styleclass"),a=e(t).data("link"),o=["hds-button","hds-button--secondary",s];e(n).removeClass(),o.forEach((function(t){e(n).addClass(t)})),e(n).data("link",a)}e(document).ready((function(){e(".issue-ajax-error__container .hds-notification__label").attr("aria-hidden","true");const i=e(".issue__meetings-select li.selected");i.length&&u(e(i)[0]),n.on("click",(function(e){t.toggle(),t.attr("aria-expanded",(function(e,n){return"true"===n?"false":"true"})),o.toggleClass("open")})),n.on("keydown",(function(n){!n.key||"ArrowDown"!==n.key&&"ArrowUp"!==n.key||"none"===t.css("display")&&(e(t).show(),e(t).attr("aria-expanded","true"),e(o).addClass("open"))})),e(a).focusout((function(n){e(this).has(n.relatedTarget).length||d(!1)})),s.on("click keydown",(function(n){n.preventDefault(),n.key&&"Enter"!==n.key||c(e(this))})),o.on("keydown",(function(e){e.key&&"Escape"===e.key&&d(!1)})),s.on("focus",(function(){r=e(s).index(e(this))})),a.on("keydown",l),e("body").on("click",".decision-navigation-button",(function(n){n.preventDefault();const s="A"===n.target.tagName?e(n.target).data("link"):e(n.target).parent("a").data("link");console.log(s),console.log(e(t).find(`[data-link='${s}']`)),c(e(t).find(`[data-link='${s}']`))}))}))}));
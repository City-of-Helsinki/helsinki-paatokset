langcode: en
status: true
dependencies:
  enforced:
    module:
      - paatokset_ahjo_api
      - paatokset_ahjo_proxy
id: ahjo_decisionmakers
migration_tags:
  - ahjo_api
  - ahjo_api_decisionmakers
migration_group: ahjo_api
label: 'Ahjo API - Decisionmakers'
source:
  plugin: ahjo_api_decisionmakers
  track_changes: true
  constants:
    title_field: title
    title_override_field: field_override_title
process:
  type:
    plugin: default_value
    default_value: policymaker
  langcode: langcode
  nid:
    plugin: callback
    callable: _paatokset_ahjo_api_lookup_policymaker_nid
    source: id
  title:
    plugin: callback
    callable: _paatokset_ahjo_api_get_existing_value_with_override
    source:
      - '@nid'
      - 'constants/title_field'
      - 'constants/title_override_field'
      - 'title'
      - '@langcode'
      - 'id'
  field_ahjo_title:
    plugin: default_value
    source: title
    default_value: id
  field_policymaker_id: id
  field_organization_type: type_label
  field_organization_type_id: type
  field_policymaker_existing: existing
  field_policymaker_formed:
    plugin: format_date
    from_format: 'U'
    to_format: 'Y-m-d\TH:i:s'
    from_timezone: UTC
    to_timezone: UTC
    source: formed
  field_policymaker_dissolved:
    plugin: format_date
    from_format: 'U'
    to_format: 'Y-m-d\TH:i:s'
    from_timezone: UTC
    to_timezone: UTC
    source: dissolved
  field_is_decisionmaker: is_decisionmaker
  field_sector_name: sector/Sector
  field_dm_sector:
    -
      plugin: single_value
      source: sector
    -
      plugin: callback
      callable: json_encode
  field_dm_org_name: parent_name
destination:
  plugin: 'entity:node'
  translations: true
migration_dependencies:
  required:
    - ahjo_organizations
